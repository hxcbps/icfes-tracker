<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Traductor Matemático | Saber 11 Master</title>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- MathJax Configuration (CONFIGURACIÓN ROBUSTA) -->
    <script>
        window.MathJax = {
            loader: { load: ['[tex]/ams'] },
            tex: {
                packages: { '[+]': ['ams'] },
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            chtml: {
                scale: 1.1,
                fontURL: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2'
            },
            options: {
                enableMenu: false,
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            startup: {
                typeset: false
            }
        };
    </script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        body {
            background-color: #f8fafc;
            font-family: 'Inter', system-ui, sans-serif;
        }

        mjx-container {
            outline: none !important;
        }

        .math-display {
            overflow-x: auto;
            overflow-y: hidden;
            padding: 10px 0;
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }

        .slide-up {
            animation: slideUp 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
        }

        /* Typography for "Book Mode" */
        .prose-custom h3 {
            color: #1e293b;
            font-weight: 800;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            font-size: 1.4rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 0.5rem;
        }

        .prose-custom h4 {
            color: #334155;
            font-weight: 700;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            font-size: 1.15rem;
        }

        .prose-custom p {
            color: #334155;
            line-height: 1.8;
            margin-bottom: 1.2rem;
            font-size: 1.05rem;
        }

        .prose-custom strong {
            color: #0f172a;
            font-weight: 700;
        }

        .prose-custom ul {
            list-style-type: disc;
            padding-left: 1.5rem;
            margin-bottom: 1rem;
            color: #334155;
        }

        .prose-custom li {
            margin-bottom: 0.5rem;
        }

        .prose-custom ol {
            list-style-type: decimal;
            padding-left: 1.5rem;
            margin-bottom: 1rem;
            color: #334155;
        }

        .btn-bounce:active {
            transform: scale(0.98);
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONOS ---
        const Icon = ({ path, size = 24, className = "", color = "currentColor" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {path}
            </svg>
        );

        const Icons = {
            Brain: <path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 4.44-4z M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-4.44-4z" />,
            Calc: <path d="M4 2h16a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1-2-2z M8 6h8 M16 14v4 M12 14v4 M8 14v4" />,
            Trend: <><polyline points="23 6 13.5 15.5 8.5 10.5 1 18" /><polyline points="17 6 23 6 23 12" /></>,
            Geo: <><path d="M21.21 15.89A10 10 0 1 1 8 2.83" /><path d="M22 12A10 10 0 0 0 12 2v10z" /></>,
            Chart: <><path d="M12 20V10" /><path d="M18 20V4" /><path d="M6 20v-4" /></>,
            Menu: <><line x1="3" y1="12" x2="21" y2="12" /><line x1="3" y1="6" x2="21" y2="6" /><line x1="3" y1="18" x2="21" y2="18" /></>,
            X: <><line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" /></>,
            Target: <><circle cx="12" cy="12" r="10" /><circle cx="12" cy="12" r="6" /><circle cx="12" cy="12" r="2" /></>,
            Bulb: <><path d="M9 18h6" /><path d="M10 22h4" /><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.26C17.81 13.47 19 11.38 19 9a7 7 0 0 0-7-7z" /></>,
            ArrowRight: <><line x1="5" y1="12" x2="19" y2="12" /><polyline points="12 5 19 12 12 19" /></>,
            Check: <polyline points="20 6 9 17 4 12" />,
            Scale: <><path d="M6 20h12" /><path d="M12 3v17" /><path d="M6 10l-4-4" /><path d="M18 10l4-4" /></>,
            Book: <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
        };

        // --- COMPONENTE DE RENDERIZADO MATEMÁTICO ---
        const MathRender = ({ content, className = "" }) => {
            const containerRef = useRef(null);

            useEffect(() => {
                if (window.MathJax && window.MathJax.typesetPromise && containerRef.current) {
                    containerRef.current.innerHTML = content;
                    window.MathJax.typesetPromise([containerRef.current])
                        .catch((err) => console.log('MathJax Error:', err));
                }
            }, [content]);

            return <div ref={containerRef} className={className} />;
        };

        // --- CONTENIDO EDUCATIVO AMPLIADO ---
        const educationalModules = [
            {
                id: "aritmetica",
                title: "Módulo 1: Aritmética y Números Reales",
                icon: "Calc",
                color: "bg-blue-700",
                concept: "Fundamentación Matemática Rigurosa",
                summary: "Desarrollo de competencias para interpretar magnitudes, manejar sistemas de unidades y calcular variaciones proporcionales bajo lógica formal.",
                chapters: [
                    {
                        title: "1. Fundamentos Operativos y Análisis Dimensional",
                        content: `
                            <div class="space-y-6 text-slate-700">
                                <div class="bg-blue-50 p-4 border-l-4 border-blue-600 rounded">
                                    <h4 class="font-bold text-blue-900 mb-2">1.1 Operaciones Básicas y Análisis Dimensional</h4>
                                    <p class="text-sm">El principal error en este tema no es el cálculo aritmético, sino la <strong>inconsistencia dimensional</strong>. No se pueden operar cantidades que no pertenezcan a la misma categoría.</p>
                                </div>

                                <div>
                                    <h5 class="font-bold text-slate-800">Verificación de Unidades</h5>
                                    <p class="mb-2">Antes de plantear una ecuación, se debe asegurar la cancelación correcta de unidades.</p>
                                    <ul class="list-disc pl-5 text-sm space-y-1">
                                        <li><strong class="text-red-600">Forma Incorrecta:</strong> Sumar Dinero + Personas.</li>
                                        <li><strong class="text-green-600">Forma Correcta:</strong> Operar tasas para obtener unidades coherentes.</li>
                                    </ul>
                                </div>

                                <div class="bg-white border p-4 rounded shadow-sm">
                                    <h5 class="font-bold text-slate-800 mb-2">Caso: Optimización con Restricciones</h5>
                                    <p class="text-sm mb-2"><strong>Planteamiento Lógico:</strong></p>
                                    <ol class="list-decimal pl-5 text-sm space-y-1">
                                        <li><strong>Variable a minimizar:</strong> Costo Total ($C$).</li>
                                        <li><strong>Restricción:</strong> La suma de estudiantes ($n$) debe ser 140.</li>
                                    </ol>
                                    <p class="text-sm mt-3 bg-slate-100 p-2 italic">
                                        "Matemáticamente, para minimizar el costo, se deben llenar primero los cupos con menor valor unitario hasta completar la demanda."
                                    </p>
                                </div>

                                <hr class="border-slate-200 my-4">

                                <div>
                                    <h4 class="font-bold text-slate-800 mb-3">1.2 Fracciones y Porcentajes (Factores Decimales)</h4>
                                    <p class="mb-2">El porcentaje debe tratarse como un <strong>factor multiplicativo decimal</strong> ($1 \\pm p$), no como una suma.</p>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-4">
                                        <div class="bg-emerald-50 p-3 rounded">
                                            <strong>Aumento ($1+p$):</strong><br>
                                            Aumento del 20% $\\to \\times 1.20$
                                        </div>
                                        <div class="bg-red-50 p-3 rounded">
                                            <strong>Descuento ($1-p$):</strong><br>
                                            Descuento del 20% $\\to \\times 0.80$
                                        </div>
                                    </div>

                                    <h5 class="font-bold text-sm text-slate-800 mt-3">Variaciones Sucesivas (No aditivas)</h5>
                                    <p class="text-sm">Si una cantidad aumenta 50% y luego disminuye 50%:</p>
                                    <div class="bg-slate-800 text-white p-3 rounded overflow-x-auto font-mono text-sm my-2">
                                        $$ X_{final} = X \\cdot (1.50) \\cdot (0.50) = X \\cdot (0.75) $$
                                    </div>
                                    <p class="text-xs text-slate-500">Conclusión: Hubo una pérdida neta del 25% ($1 - 0.75$).</p>
                                </div>

                                <hr class="border-slate-200 my-4">

                                <div>
                                    <h4 class="font-bold text-slate-800 mb-2">1.3 Razones y Proporciones</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                        <div class="border p-3 rounded">
                                            <strong class="text-blue-700">Directa ($y = kx$)</strong>
                                            <p>El cociente es constante $\\frac{y}{x} = k$.<br>Ej: Cantidad vs Precio.</p>
                                        </div>
                                        <div class="border p-3 rounded">
                                            <strong class="text-purple-700">Inversa ($y = k/x$)</strong>
                                            <p>El producto es constante $x \\cdot y = k$.<br>Ej: Trabajadores vs Tiempo.</p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h4 class="font-bold text-slate-800 mt-4 mb-2">1.4 Notación Científica</h4>
                                    <p class="text-sm">Formato $a \\times 10^n$, donde $1 \\le |a| < 10$.</p>
                                    <div class="bg-slate-100 p-2 rounded text-sm font-mono mt-2">
                                        $$ 0.006 = 6 \\times 10^{-3} $$
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        title: "2. Teoría de Números y Patrones",
                        content: `
                            <div class="space-y-6 text-slate-700">
                                <div class="bg-indigo-50 p-4 border-l-4 border-indigo-600 rounded">
                                    <p class="text-sm text-indigo-900">
                                        El ICFES evalúa la capacidad de predecir eventos futuros (periodicidad) o distribuir recursos de manera exacta (partición).
                                    </p>
                                </div>

                                <div>
                                    <h4 class="font-bold text-slate-800 mb-2">1.5 MCM y MCD</h4>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-3">
                                        <div>
                                            <strong class="text-blue-700 block mb-1">A. MCM (Punto de Encuentro)</strong>
                                            <p class="text-sm mb-2">Para problemas de <strong>Periodicidad</strong>. "¿Cuándo vuelven a coincidir?".</p>
                                            <div class="bg-blue-50 p-2 rounded text-xs">
                                                Ej: Bus A (4 min), Bus B (6 min).<br>
                                                MCM(4,6) = 12 min.<br>
                                                Coinciden a las 8:12 AM.
                                            </div>
                                        </div>
                                        <div>
                                            <strong class="text-green-700 block mb-1">B. MCD (Corte Perfecto)</strong>
                                            <p class="text-sm mb-2">Para problemas de <strong>Partición</strong>. "¿Mayor tamaño posible sin sobrar?".</p>
                                            <div class="bg-green-50 p-2 rounded text-xs">
                                                Ej: Cuerdas de 12m y 18m.<br>
                                                MCD(12,18) = 6m.<br>
                                                Pedazos de 6 metros.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr class="border-slate-200 my-4">

                                <div>
                                    <h4 class="font-bold text-slate-800 mb-2">1.6 Sucesiones Aritméticas ($a_n$)</h4>
                                    <p class="text-sm mb-2">Formalización matemática para evitar el conteo manual.</p>
                                    <div class="bg-slate-800 text-white p-3 rounded text-center my-2 font-mono text-lg">
                                        $$ a_n = a_1 + (n-1)d $$
                                    </div>
                                    <ul class="text-sm list-disc pl-5 text-slate-600">
                                        <li>$a_n$: Valor en la posición $n$.</li>
                                        <li>$a_1$: Valor inicial.</li>
                                        <li>$d$: Diferencia constante.</li>
                                        <li>$(n-1)$: Cantidad de intervalos (el principio estructural).</li>
                                    </ul>
                                </div>

                                <div>
                                    <h4 class="font-bold text-slate-800 mt-4 mb-2">1.7 Operaciones con Racionales</h4>
                                    <p class="text-sm">Para dividir fracciones $\\frac{a}{b} \\div \\frac{c}{d}$ (Extremos y Medios):</p>
                                    <div class="bg-slate-100 p-2 rounded text-center text-sm font-mono mt-1">
                                        $$ \\frac{\\frac{a}{b}}{\\frac{c}{d}} = \\frac{a \\cdot d}{b \\cdot c} $$
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        title: "3. Mezclas, Desigualdades y Estimación",
                        content: `
                            <div class="space-y-6 text-slate-700">
                                <div>
                                    <h4 class="font-bold text-slate-800 mb-3">1.9 Desigualdades e Intervalos</h4>
                                    <p class="text-sm mb-3">Traducción de lenguaje natural a simbología de límites.</p>
                                    
                                    <table class="w-full text-sm text-left border rounded">
                                        <thead class="bg-slate-100 font-bold text-slate-700">
                                            <tr><th class="p-2">Frase</th><th class="p-2">Símbolo</th></tr>
                                        </thead>
                                        <tbody class="divide-y text-slate-600">
                                            <tr><td class="p-2">"Como mínimo", "Al menos"</td><td class="p-2 font-mono">$\\ge$</td></tr>
                                            <tr><td class="p-2">"Como máximo", "A lo sumo"</td><td class="p-2 font-mono">$\\le$</td></tr>
                                            <tr><td class="p-2">"Superior a"</td><td class="p-2 font-mono">$>$</td></tr>
                                        </tbody>
                                    </table>

                                    <div class="bg-red-50 p-3 mt-3 rounded text-sm border-l-4 border-red-500 text-red-900">
                                        <strong>Propiedad Crítica:</strong> Al multiplicar o dividir por un número negativo, el sentido de la desigualdad se invierte.<br>
                                        ($-2x > 10 \\implies x < -5$).
                                    </div>
                                </div>

                                <hr class="border-slate-200 my-4">

                                <div>
                                    <h4 class="font-bold text-slate-800 mb-3">1.10 Promedios Ponderados y Mezclas</h4>
                                    <p class="text-sm mb-2">El promedio simple asume igualdad de pesos. En mezclas, usamos el <strong>Peso ($w_i$)</strong>.</p>
                                    <div class="bg-slate-800 text-white p-3 rounded text-center mb-3 text-sm font-mono">
                                        $$ \\bar{x}_w = \\frac{\\sum (x_i \\cdot w_i)}{\\sum w_i} $$
                                    </div>
                                    <div class="bg-white border p-3 rounded text-sm">
                                        <strong>Ejemplo Práctico:</strong> 20kg a $5k + 30kg a $8k.
                                        <br>Precio $\\neq \\frac{5+8}{2}$.
                                        <br>Precio $= \\frac{(20 \\cdot 5000) + (30 \\cdot 8000)}{50} = \\mathbf{6.800}$
                                    </div>
                                </div>

                                <div>
                                    <h4 class="font-bold text-slate-800 mt-4 mb-2">1.11 Números Irracionales</h4>
                                    <p class="text-sm">Diferenciar valor exacto de aproximación.</p>
                                    <ul class="list-disc pl-5 text-sm space-y-1 font-mono text-slate-600">
                                        <li>$\\pi \\approx 3.1416$ (Circunferencia)</li>
                                        <li>$\\sqrt{2} \\approx 1.41$ (Diagonal cuadrado)</li>
                                        <li>$\\sqrt{3} \\approx 1.73$ (Altura triángulo equilátero)</li>
                                    </ul>
                                </div>
                            </div>
                        `
                    },
                    {
                        title: "4. Operaciones Avanzadas y Simplificación",
                        content: `
                            <div class="space-y-6 text-slate-700">
                                <div>
                                    <h4 class="font-bold text-slate-800 mb-2">1.13 Valor Absoluto (Distancia)</h4>
                                    <p class="text-sm mb-2">Geométricamente, es la distancia al cero. $|x| \\ge 0$.</p>
                                    <div class="bg-slate-100 p-2 rounded text-sm italic border-l-2 border-slate-400">
                                        Interpretación: $|x - 5| = 3$ significa "Números cuya distancia al 5 es 3".<br>
                                        Soluciones: 2 y 8.
                                    </div>
                                </div>

                                <hr class="border-slate-200 my-4">

                                <div>
                                    <h4 class="font-bold text-slate-800 mb-2">1.14 Racionalización</h4>
                                    <p class="text-sm mb-2">Estándar matemático: No dejar raíces en el denominador.</p>
                                    <ul class="list-disc pl-5 text-sm space-y-2">
                                        <li><strong>Monomio:</strong> $\\frac{1}{\\sqrt{a}} \\cdot \\frac{\\sqrt{a}}{\\sqrt{a}} = \\frac{\\sqrt{a}}{a}$.</li>
                                        <li><strong>Binomio:</strong> Usar el <strong>Conjugado</strong>. Multiplicar por $(\\sqrt{a} - \\sqrt{b})$ para generar diferencia de cuadrados.</li>
                                    </ul>
                                </div>

                                <hr class="border-slate-200 my-4">

                                <div>
                                    <h4 class="font-bold text-slate-800 mb-2">1.15 Logaritmos (Buscadores de Exponentes)</h4>
                                    <p class="text-sm mb-2">Definición: $\\log_b(x) = y \\iff b^y = x$.</p>
                                    <div class="bg-amber-50 p-3 rounded border border-amber-200">
                                        <strong class="text-amber-900 text-sm block mb-1">Propiedades Fundamentales:</strong>
                                        <ul class="font-mono text-xs text-amber-800 space-y-1">
                                            <li>Prod: $\\log(A \\cdot B) = \\log A + \\log B$</li>
                                            <li>Cociente: $\\log(A / B) = \\log A - \\log B$</li>
                                            <li>Potencia: $\\log(A^n) = n \\cdot \\log A$</li>
                                        </ul>
                                    </div>
                                </div>

                                <div>
                                    <h4 class="font-bold text-slate-800 mt-4 mb-2">1.16 Exponentes Fraccionarios</h4>
                                    <div class="text-center bg-slate-100 p-2 font-mono text-lg rounded">
                                        $$ x^{m/n} = \\sqrt[n]{x^m} $$
                                    </div>
                                    <p class="text-xs text-center mt-1 text-slate-500">El denominador es la raíz, el numerador es la potencia.</p>
                                </div>
                            </div>
                        `
                    },
                    {
                        title: "5. Aplicaciones: Finanzas y Conjuntos",
                        content: `
                            <div class="space-y-6 text-slate-700">
                                <div>
                                    <h4 class="font-bold text-slate-800 mb-3">1.17 Matemática Financiera</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                        <div class="border p-3 rounded hover:bg-slate-50 transition">
                                            <strong class="text-blue-700 block mb-1">Interés Simple (Lineal)</strong>
                                            <p class="mb-2 text-xs">Solo gana sobre capital inicial.</p>
                                            <div class="font-mono text-center bg-white p-1 border">$$ I = C \\cdot i \\cdot t $$</div>
                                        </div>
                                        <div class="border p-3 rounded hover:bg-slate-50 transition">
                                            <strong class="text-purple-700 block mb-1">Interés Compuesto (Exp)</strong>
                                            <p class="mb-2 text-xs">Interés genera interés (Capitalización).</p>
                                            <div class="font-mono text-center bg-white p-1 border">$$ V_f = C(1+i)^t $$</div>
                                        </div>
                                    </div>
                                    <p class="text-xs text-slate-500 mt-2 italic">Nota: El tiempo en compuesto es un exponente, no un multiplicador.</p>
                                </div>

                                <hr class="border-slate-200 my-4">

                                <div>
                                    <h4 class="font-bold text-slate-800 mb-2">1.18 Teoría de Conjuntos</h4>
                                    <p class="text-sm mb-2">Principio de Inclusión-Exclusión para evitar el conteo doble.</p>
                                    <div class="bg-slate-800 text-white p-3 rounded text-center text-sm font-mono mb-2">
                                        $$ n(A \\cup B) = n(A) + n(B) - n(A \\cap B) $$
                                    </div>
                                    <p class="text-sm">Al sumar los conjuntos individuales, se suma la intersección dos veces. Se debe restar esa duplicidad.</p>
                                </div>

                                <div>
                                    <h4 class="font-bold text-slate-800 mt-4 mb-2">1.19 Conversión en Cadena</h4>
                                    <p class="text-sm">Multiplicar por fracciones unitarias para cancelar unidades.</p>
                                    <div class="font-mono text-xs bg-slate-100 p-2 rounded">
                                        $$ 90 \\frac{km}{h} \\times \\frac{1000m}{1km} \\times \\frac{1h}{3600s} = 25 m/s $$
                                    </div>
                                </div>
                            </div>
                        `
                    }
                ],
                tips: [
                    "Verifica siempre la consistencia dimensional ($km + km$, no $km + horas$).",
                    "En inecuaciones, voltea el signo si multiplicas por negativos.",
                    "El interés compuesto es exponencial; el simple es lineal.",
                    "log(A*B) es la suma de logaritmos, no el logaritmo de la suma."
                ]
            },
            {
                id: "variacion",
                title: "Teoría del Cambio y Modelado",
                icon: "Trend",
                color: "bg-emerald-700",
                concept: "Cálculo Diferencial Intuitivo",
                summary: "Todo en el examen cambia de dos formas: sumando (Lineal) o multiplicando (Exponencial). Este módulo te enseña a detectar la 'huella digital' matemática de cada fenómeno en el texto.",
                chapters: [
                    {
                        title: "Capítulo I: La Huella Lineal",
                        content: `<p>Si el problema dice 'aumenta 2 grados <strong>por cada</strong> metro' o 'cobra $500 <strong>por cada</strong> minuto', la relación es lineal ($y = mx + b$). La palabra clave es 'constante' o 'por cada'. En la Pregunta 8, la temperatura baja de forma constante.</p>`
                    },
                    {
                        title: "Capítulo II: La Huella Exponencial",
                        content: `<p>Si el problema habla de <strong>porcentajes acumulados</strong> ('aumenta 3% cada año'), es exponencial. El crecimiento no es fijo, depende del tamaño actual. En la Pregunta 49, el precio no sube $X pesos, sube un % del valor anterior.</p>`
                    }
                ]
            },
            {
                id: "intro",
                title: "Filosofía del Examen",
                icon: "Brain",
                color: "bg-purple-800",
                concept: "Metacognición",
                summary: "Entender el examen es más importante que memorizar datos. Aquí analizamos la estructura psicológica de las preguntas.",
                chapters: [
                    {
                        title: "Capítulo I: Lectura Crítica Matemática",
                        content: `<p>El 50% de los errores no son de cálculo, son de lectura. Ignorar unidades, confundir radio con diámetro, o no ver un 'NO' en la pregunta.</p>`
                    }
                ]
            },
            {
                id: "geometria",
                title: "Geometría Analítica y Escalar",
                icon: "Geo",
                color: "bg-orange-600",
                concept: "Relaciones Espaciales",
                summary: "El espacio no se comporta linealmente. Las áreas y volúmenes tienen reglas de crecimiento explosivo que el examen adora evaluar.",
                chapters: [
                    {
                        title: "Capítulo I: Ley Cuadrático-Cúbica",
                        content: `<p>Si duplicas el lado de un cuadrado, su área se cuadruplica ($2^2=4$). Si duplicas el lado de un cubo, su volumen se octuplica ($2^3=8$). Esta es la trampa de la Pregunta 7.</p>`
                    }
                ]
            },
            {
                id: "datos",
                title: "Estadística Inferencial",
                icon: "Chart",
                color: "bg-rose-700",
                concept: "Interpretación de Datos",
                summary: "La estadística en el ICFES no es calcular, es interpretar qué significan la media y la desviación en la vida real.",
                chapters: [
                    {
                        title: "Capítulo I: Invarianza de la Dispersión",
                        content: `<p>Si sumas un valor constante a todos los datos, el promedio sube, pero la dispersión (desviación estándar) se mantiene intacta. Pregunta 24.</p>`
                    }
                ]
            }
        ];

        // --- GENERADOR DE PREGUNTAS (SIMULADOR INFINITO) ---

        const generateQuestion = (type) => {
            const r = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

            const templates = {
                // SESIÓN 1: TRANSPORTE (Intervalos vs Puntos)
                transport_intervals: () => {
                    const stops = r(6, 12);
                    const timePerSegment = r(3, 6); // minutes
                    const timePerStop = 30; // seconds

                    const segments = stops - 1;
                    const totalMinutesCalculation = segments * timePerSegment;
                    const totalSecondsCalculation = timePerStop;

                    return {
                        id: Math.random(),
                        category: "Análisis de Algoritmos",
                        text: `Un bus recorre una ruta con ${stops} estaciones consecutivas ($E_1$ a $E_{${stops}}$). Tarda ${timePerSegment} min entre estaciones y para ${timePerStop} seg en cada estación intermedia. Un usuario estima: "Hay ${stops} estaciones, así que multiplico ${stops} $\\times$ ${timePerSegment} min". ¿Qué error comete?`,
                        options: [
                            { id: "A", text: `Error de Intervalo: Hay ${stops} estaciones pero solo ${segments} tramos de viaje.`, correct: true },
                            { id: "B", text: `Error de Unidad: No sumó los tiempos de parada en segundos.` },
                            { id: "C", text: `Error de Operación: Debió dividir en lugar de multiplicar.` },
                            { id: "D", text: `No hay error, el cálculo es aproximado pero válido.` }
                        ],
                        explanation: `<strong>Principio de Postes e Intervalos:</strong> Si tienes $n$ puntos en línea, tienes $n-1$ espacios entre ellos. De $E_1$ a $E_{${stops}}$ hay solo ${segments} tramos. Multiplicar por ${stops} añade un tramo inexistente.`
                    };
                },

                // SESIÓN 2: MONEDA (Invarianza)
                currency_invariance: () => {
                    const rate = r(2000, 4000);
                    const gainPercent = r(2, 10);

                    return {
                        id: Math.random(),
                        category: "Porcentajes Relativos",
                        text: `Ana invierte en Euros. La tasa es 1 EUR = ${rate} COP (constante). Su inversión en Euros crece un ${gainPercent}%. Su hermano dice: "En pesos ganaste más del ${gainPercent}%, porque el Euro vale ${rate} veces más".`,
                        options: [
                            { id: "A", text: `Verdadero: La ganancia en pesos se multiplica por ${rate}.` },
                            { id: "B", text: `Falso: El porcentaje es el mismo (${gainPercent}%) sin importar la moneda.`, correct: true },
                            { id: "C", text: `Falso: En pesos gana menos porque la moneda es más débil.` },
                            { id: "D", text: `Depende del monto inicial de la inversión.` }
                        ],
                        explanation: `<strong>Invarianza:</strong> $$P_{final} = k \\cdot D_{final} = k \\cdot (1.${gainPercent} \\cdot D_{inicial})$$. La tasa $k$ multiplica tanto al inicio como al final, por lo que se cancela al calcular la proporción de ganancia.`
                    };
                },

                // SESIÓN 3: ESCALAS (Cuadrática)
                geometry_scaling: () => {
                    const k = r(2, 4);
                    const shape = Math.random() > 0.5 ? "cuadrado" : "círculo";
                    const dimName = shape === "cuadrado" ? "lado" : "radio";

                    return {
                        id: Math.random(),
                        category: "Geometría Escalar",
                        text: `Se tiene un ${shape}. Si su ${dimName} aumenta ${k} veces (se multiplica por ${k}), ¿qué sucede con su área?`,
                        options: [
                            { id: "A", text: `El área aumenta ${k} veces.`, correct: false },
                            { id: "B", text: `El área aumenta ${k * 2} veces.` },
                            { id: "C", text: `El área aumenta ${k * k} veces.`, correct: true },
                            { id: "D", text: `El área se mantiene igual.` }
                        ],
                        explanation: `<strong>Ley Cuadrático-Cúbica:</strong> La relación de áreas es el cuadrado de la relación lineal. Si $L_2 = ${k} L_1$, entonces $A_2 = (${k})^2 A_1 = ${k * k} A_1$.`
                    };
                },

                // SESIÓN 4: MODELADO (Lineal Negativo)
                function_modeling: () => {
                    const startVal = r(80, 100);
                    const slope = r(2, 5);
                    const variable = "tiempo";

                    return {
                        id: Math.random(),
                        category: "Modelado de Funciones",
                        text: `Un tanque tiene ${startVal} litros. Se abre un desagüe y pierde ${slope} litros por minuto. ¿Cuál ecuación describe el volumen $V$ en función del tiempo $t$?`,
                        options: [
                            { id: "A", text: `$V = ${startVal} - ${slope}t$`, correct: true },
                            { id: "B", text: `$V = ${slope}t - ${startVal}$` },
                            { id: "C", text: `$V = ${startVal} + ${slope}t$` },
                            { id: "D", text: `$V = (${startVal}/${slope})t$` }
                        ],
                        explanation: `<strong>Ecuación Afín:</strong> Valor Inicial $b = ${startVal}$. Tasa de cambio (pendiente) $m = -${slope}$ (porque pierde). La forma es $y = b + mx \\to V = ${startVal} - ${slope}t$.`
                    };
                },

                // MEZCLA ALEATORIA DE LAS ANTERIORES PARA VARIEDAD
                algebra_classic: () => {
                    return {
                        id: Math.random(),
                        category: "Lógica Algebraica",
                        text: `Si Juan tiene el triple de edad que Pedro ($J$ y $P$), ¿cómo se escribe?`,
                        options: [
                            { id: "A", text: `$J = 3P$`, correct: true },
                            { id: "B", text: `$P = 3J$` },
                            { id: "C", text: `$J = P + 3$` },
                            { id: "D", text: `$3J = P$` }
                        ],
                        explanation: "Si Juan es mayor (tiene más edad), para igualar la balanza debes multiplicar la edad del menor (Pedro) por 3."
                    }
                }
            };

            const keys = Object.keys(templates);
            const randomType = keys[Math.floor(Math.random() * keys.length)];
            return templates[randomType]();
        };

        // --- COMPONENTES UI (Iguales al original, estructura mantenida) ---

        const MenuButton = ({ onClick }) => (
            <button onClick={onClick} className="fixed top-4 left-4 z-50 p-3 bg-slate-900 text-white rounded-full shadow-lg hover:bg-slate-800 transition-all md:hidden">
                <Icon path={Icons.Menu} />
            </button>
        );

        const Sidebar = ({ isOpen, setView, activeView, closeSidebar }) => (
            <>
                {isOpen && <div className="fixed inset-0 bg-black/60 z-30 md:hidden fade-in" onClick={closeSidebar}></div>}
                <aside className={`fixed inset-y-0 left-0 z-40 w-80 bg-slate-900 text-slate-100 transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : '-translate-x-full'} md:relative md:translate-x-0 flex flex-col shadow-2xl`}>
                    <div className="p-8 border-b border-slate-800">
                        <h2 className="font-black text-2xl text-white mb-2 tracking-tight">El Traductor</h2>
                        <p className="text-slate-400 text-sm font-medium">Edición Libro Maestro</p>
                    </div>

                    <nav className="flex-1 overflow-y-auto p-4 space-y-3">
                        <div className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 ml-2 mt-2">Capítulos de Estudio</div>
                        {educationalModules.map((mod) => (
                            <button
                                key={mod.id}
                                onClick={() => { setView('learn', mod.id); closeSidebar(); }}
                                className={`w-full flex items-start gap-4 px-4 py-4 rounded-xl transition-all group relative overflow-hidden ${activeView.id === mod.id && activeView.mode === 'learn' ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-400 hover:bg-slate-800 hover:text-white'}`}
                            >
                                <div className={`mt-1 relative z-10 transition-transform group-hover:scale-110 ${activeView.id === mod.id ? 'text-white' : 'text-slate-500 group-hover:text-blue-400'}`}>
                                    <Icon path={Icons[mod.icon]} size={20} />
                                </div>
                                <div className="text-left relative z-10">
                                    <span className="block font-bold text-base">{mod.title}</span>
                                    <span className={`block text-xs mt-1 leading-snug ${activeView.id === mod.id ? 'text-blue-100' : 'text-slate-600 group-hover:text-slate-400'}`}>{mod.concept}</span>
                                </div>
                                {activeView.id === mod.id && <div className="absolute inset-0 bg-gradient-to-r from-blue-600 to-blue-500 z-0"></div>}
                            </button>
                        ))}

                        <div className="my-8 border-t border-slate-800"></div>
                        <div className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 ml-2">Evaluación</div>
                        <button
                            onClick={() => { setView('quiz'); closeSidebar(); }}
                            className={`w-full flex items-center gap-4 px-4 py-5 rounded-xl transition-all ${activeView.mode === 'quiz' ? 'bg-indigo-600 text-white shadow-lg' : 'bg-slate-800/50 text-slate-300 hover:bg-indigo-900/30 hover:text-white border border-slate-800'}`}
                        >
                            <Icon path={Icons.Target} className="text-indigo-400" />
                            <div className="text-left">
                                <span className="block font-bold">Simulador Infinito</span>
                                <span className="block text-xs text-slate-500 mt-1">Generación Procedural</span>
                            </div>
                        </button>
                    </nav>
                </aside>
            </>
        );

        const BookChapter = ({ title, content }) => (
            <div className="mb-12 pl-6 border-l-4 border-slate-200 hover:border-blue-600 transition-all duration-300">
                <h3 className="text-xl font-bold text-slate-900 mb-4">{title}</h3>
                <MathRender className="prose-custom" content={content} />
            </div>
        );

        const LearningView = ({ module }) => {
            return (
                <div className="w-full h-screen overflow-y-auto bg-white">
                    <div className={`${module.color} text-white p-8 md:p-16 relative overflow-hidden shadow-2xl`}>
                        <div className="absolute top-0 right-0 p-32 bg-white opacity-5 rounded-full transform translate-x-1/2 -translate-y-1/2"></div>
                        <div className="max-w-4xl mx-auto relative z-10">
                            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-black/20 text-xs font-bold uppercase tracking-widest mb-6 backdrop-blur-sm">
                                <Icon path={Icons.Book} size={14} /> Módulo Maestro
                            </div>
                            <h1 className="text-4xl md:text-6xl font-black mb-6 tracking-tight">{module.title}</h1>
                            <p className="text-xl md:text-2xl text-white/90 font-medium leading-relaxed max-w-2xl">{module.summary}</p>
                        </div>
                    </div>

                    <div className="max-w-4xl mx-auto p-8 md:p-16 pb-32">
                        {module.chapters ? (
                            module.chapters.map((chapter, index) => (
                                <BookChapter key={index} title={chapter.title} content={chapter.content} />
                            ))
                        ) : (
                            <div className="text-center py-20 text-slate-500">
                                Contenido en construcción para este módulo.
                            </div>
                        )}

                        <div className="mt-20 p-8 bg-slate-50 rounded-2xl border border-slate-200 shadow-sm">
                            <h4 className="font-bold text-slate-900 mb-6 flex items-center gap-2 text-lg">
                                <Icon path={Icons.Brain} className="text-slate-600" /> Reglas de Oro para el Examen
                            </h4>
                            <ul className="space-y-4">
                                {module.tips && module.tips.map((tip, i) => (
                                    <li key={i} className="flex gap-4 text-slate-700 items-start">
                                        <div className="mt-1 p-1 bg-green-100 rounded-full text-green-700 shrink-0">
                                            <Icon path={Icons.Check} size={14} />
                                        </div>
                                        <div className="text-base"><MathRender content={tip} /></div>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    </div>
                </div>
            );
        };

        const QuizView = () => {
            const [question, setQuestion] = useState(null);
            const [selected, setSelected] = useState(null);
            const [score, setScore] = useState(0);
            const [streak, setStreak] = useState(0);

            const nextQuestion = () => {
                setQuestion(generateQuestion());
                setSelected(null);
            };

            useEffect(() => {
                nextQuestion();
            }, []);

            const handleSelect = (opt) => {
                if (selected) return;
                setSelected(opt);
                if (opt.correct) {
                    setScore(s => s + 10);
                    setStreak(s => s + 1);
                } else {
                    setStreak(0);
                }
            };

            if (!question) return <div className="flex h-screen items-center justify-center text-slate-500">Cargando simulador...</div>;

            return (
                <div className="w-full h-screen overflow-y-auto bg-slate-50 flex items-center justify-center p-4">
                    <div className="max-w-2xl w-full">
                        <div className="flex justify-between items-end mb-6 px-2">
                            <div>
                                <h2 className="text-2xl font-black text-slate-800">Simulador</h2>
                                <p className="text-slate-500 text-sm">Práctica infinita (Nuevos temas incluidos)</p>
                            </div>
                            <div className="flex gap-4">
                                <div className="text-right">
                                    <span className="text-xs font-bold text-slate-400 uppercase">Puntos</span>
                                    <div className="text-xl font-black text-indigo-600">{score}</div>
                                </div>
                                <div className="text-right">
                                    <span className="text-xs font-bold text-slate-400 uppercase">Racha</span>
                                    <div className="text-xl font-black text-orange-500">{streak}</div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden relative">
                            <div className="p-8 md:p-10">
                                <span className="inline-block px-3 py-1 bg-indigo-50 text-indigo-700 text-xs font-bold rounded-full mb-6 uppercase tracking-wide border border-indigo-100">
                                    {question.category}
                                </span>
                                <h3 className="text-xl md:text-2xl font-bold text-slate-800 mb-8 leading-relaxed">
                                    <MathRender content={question.text} />
                                </h3>

                                <div className="space-y-3">
                                    {question.options.map((opt) => (
                                        <button
                                            key={opt.id}
                                            onClick={() => handleSelect(opt)}
                                            disabled={!!selected}
                                            className={`w-full p-5 rounded-2xl text-left border-2 transition-all relative group
                                                ${selected
                                                    ? opt.correct
                                                        ? 'bg-green-50 border-green-500 text-green-900'
                                                        : opt === selected
                                                            ? 'bg-red-50 border-red-500 text-red-900'
                                                            : 'bg-slate-50 border-slate-100 text-slate-400 opacity-50'
                                                    : 'bg-white border-slate-100 hover:border-indigo-500 hover:shadow-md text-slate-700 font-medium btn-bounce'
                                                }
                                            `}
                                        >
                                            <div className="flex items-start gap-4">
                                                <span className={`font-black text-lg ${selected && opt.correct ? 'text-green-600' : 'text-slate-300 group-hover:text-indigo-500'}`}>{opt.id}</span>
                                                <span className="mt-0.5"><MathRender content={opt.text} /></span>
                                            </div>

                                            {selected && opt.correct && (
                                                <div className="absolute right-6 top-1/2 -translate-y-1/2 text-green-600 bg-white rounded-full p-1 shadow-sm">
                                                    <Icon path={Icons.Check} />
                                                </div>
                                            )}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {selected && (
                                <div className="bg-slate-900 p-8 md:p-10 text-white slide-up">
                                    <div className="flex gap-4 mb-4">
                                        <div className={`p-2 rounded-lg ${selected.correct ? 'bg-green-500' : 'bg-red-500'}`}>
                                            <Icon path={selected.correct ? Icons.Check : Icons.X} size={24} className="text-white" />
                                        </div>
                                        <div>
                                            <div className="font-bold text-lg">
                                                {selected.correct ? '¡Correcto!' : 'Análisis del Error'}
                                            </div>
                                            <div className="text-slate-400 text-sm">Entendiendo la lógica del ICFES</div>
                                        </div>
                                    </div>

                                    <div className="text-slate-300 mb-8 leading-relaxed border-l-2 border-slate-700 pl-4">
                                        <MathRender content={question.explanation} />
                                    </div>

                                    <button
                                        onClick={nextQuestion}
                                        className="w-full py-4 bg-white text-slate-900 font-bold rounded-xl hover:bg-indigo-50 transition-colors flex items-center justify-center gap-2"
                                    >
                                        Siguiente Desafío <Icon path={Icons.ArrowRight} />
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [mode, setMode] = useState('learn'); // 'learn' or 'quiz'
            const [moduleId, setModuleId] = useState('aritmetica');

            const activeView = { mode, id: moduleId };
            const currentModule = educationalModules.find(m => m.id === moduleId);

            const handleSetView = (newMode, newId) => {
                setMode(newMode);
                if (newId) setModuleId(newId);
            };

            return (
                <div className="flex h-screen bg-white overflow-hidden">
                    <MenuButton onClick={() => setSidebarOpen(true)} />
                    <Sidebar
                        isOpen={sidebarOpen}
                        closeSidebar={() => setSidebarOpen(false)}
                        activeView={activeView}
                        setView={handleSetView}
                    />

                    <main className="flex-1 h-full relative">
                        {mode === 'learn' ? (
                            <LearningView module={currentModule} />
                        ) : (
                            <QuizView />
                        )}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>